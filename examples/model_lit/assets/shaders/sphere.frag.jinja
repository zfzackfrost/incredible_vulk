{% extends "lib/lighting/physical.frag.jinja" %}

{% block libs %}
    {{ super() }}
    {% include "lib/math.glsl.jinja" %}
{% endblock %}

{% block uniforms %}
    {{ super() }}
    {% call uniform.user(0) -%}sampler2D albedoTex{%- endcall %}
    {% call uniform.user(1) -%}sampler2D normalTex{%- endcall %}
    {% call uniform.user(2) -%}sampler2D metallicTex{%- endcall %}
    {% call uniform.user(3) -%}sampler2D roughnessTex{%- endcall %}
{% endblock %}

{% block io %}
    {{ super() }}

    vec2 getTexCoords()
    {
        return fsIn.texCoords * 2.0;
    }
{% endblock %}

{% block post %}

{% include "lib/lighting/normalmap.glsl.jinja" %}

{{ super() }}
{% endblock %}

{% block shininess %}
    return 8.0;
{% endblock %}
{% block matNormal -%}
    vec3 norm = texture(normalTex, getTexCoords()).rgb;
    return flattenNormal(norm, -2.5);
{%- endblock %}
{% block matAlbedo -%}
    return texture(albedoTex, getTexCoords()).rgb;
{%- endblock %}
{% block matMetallic -%}
    return texture(metallicTex, getTexCoords()).r;
{%- endblock %}
{% block matRoughness -%}
    return texture(roughnessTex, getTexCoords()).r;
{%- endblock %}
